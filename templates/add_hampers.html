<!-- add_hampers.html -->

{% extends 'base.html' %}

{% block title %}Add Hampers - CK PO App{% endblock %}

{% block content %}
    <head>
        <title>Add Product</title>
        <style>
            table {
                width: 100%;
            }
            .center_form{
                width: 40%;
                margin: auto;
                margin-top: 20px;
                background-color: #cccaca;
                padding: 10px 10px 10px 10px;
            }

            .product-option{
                float:none;
                background-color: #ababab;
            }
        </style>
    </head>
    <body>
        <form action="/submit_addition_hampers" method="post" enctype="multipart/form-data">
            <div class="center_form">
                <!-- Inputs for hampers -->
                <div>
                    <table style="border:none">
                        <tr>
                            <td style="width:30%">Hampers Name</td>
                            <td><input type="text" name="hname"></td>
                        </tr>
                        <tr>
                            <td>Hamper Contents</td>
                            <td>
                                <ul id="product-list" style="list-style-type: none; padding: 0;">
                                    {% for product in productsList %}
                                        <li class="product-option">
                                            <input type="checkbox" name="products[]" value="{{ product._id }}" id="product_{{ product._id }}">
                                            <label for="product_{{ product._id }}">{{ product.name }}</label>
                                            <input type="number" name="quantities_{{ product._id }}" class="quantity-input" placeholder="Quantity" style="display: none;">
                                        </li>
                                    {% endfor %}
                                </ul>
                            </td>
                        </tr>
                        <tr>
                            <td>Price</td>
                            <td>
                                <div id="priceInputs">
                                    <div class="price-input">
                                        <label for="priceName">Price Name 1:</label>
                                        <input type="text" name="priceName[]" style="width:20%">
                                        <label for="priceValue">Price Value 1:</label>
                                        <input type="number" name="priceValue[]" style="width:20%">
                                    </div>
                                </div>
                                <button type="button" onclick="addPriceInput()">Add Price</button>
                                <button type="button" onclick="removePriceInput()">Remove Price</button>
                            </td>
                        </tr>
                    </table>
                    <br>
                    <input type="submit"></input>
                </div>
            </div>
        </form>

        
        <script>
            function addPriceInput() {
                const priceInputs = document.getElementById('priceInputs');
                const newPriceInput = document.createElement('div');
                const count = priceInputs.childElementCount + 1;

                newPriceInput.innerHTML = `
                    <div class="price-input">
                        <label for="priceName">Price Name ${count}:</label>
                        <input type="text" name="priceName[]" required style="width:20%">
                        <label for="priceValue">Price Value ${count}:</label>
                        <input type="number" name="priceValue[]" required style="width:20%">
                    </div>
                `;

                priceInputs.appendChild(newPriceInput);
            }

            function removePriceInput() {
                const priceInputs = document.getElementById('priceInputs');
                if (priceInputs.childElementCount > 1) {
                    priceInputs.removeChild(priceInputs.lastElementChild);
                }
            }
            document.addEventListener('DOMContentLoaded', function () {
                var productList = document.getElementById('product-list');

                productList.addEventListener('change', function (event) {
                    var target = event.target;

                    if (target.type === 'checkbox') {
                        var quantityInput = target.parentElement.querySelector('.quantity-input');

                        if (target.checked) {
                            quantityInput.style.display = 'inline-block';
                        } else {
                            quantityInput.style.display = 'none';
                        }
                    }
                });
            });
        </script>
    </body>
{% endblock %}